"use strict";function generateMap(e){var t=arguments.length<=1||void 0===arguments[1]?e:arguments[1],o=document.querySelector("#map"),a={columns:void 0,rows:void 0,nodes:[],init:function(e,t){this.columns=e,this.rows=t}};a.init(e,t);var r={init:function(e,t){this.element?console.error("Node already defined: ",this):(this.element=document.createElement("div"),this.element.className="node",this.x=e,this.y=t,this.state=null,this.element.setAttribute("style","height: "+parseFloat(80/this.columns)+"vh;\n           width: "+parseFloat(80/this.rows)+"vh;"))}};Object.setPrototypeOf(r,a);for(var n=e-1;n>0;n--){a.nodes.unshift([]);for(var l=0;l<t;l++){var s=Object.create(r);s.init(l,n),s.element.setAttribute("x",l),s.element.setAttribute("y",n),s.element.addEventListener("mousedown",changeNodeState),s.element.addEventListener("mouseover",changeNodeState),s.element.innerHTML=l+","+n,a.nodes[0].push(s),o.appendChild(s.element)}}return console.log("%cNodes created.","color: green; font-weight: bold"),a}function getTargetNode(e,t){return e>=0&&e<gameMap.columns&&t>=0&&t<gameMap.rows?gameMap.nodes[t-1][e]:void 0}function changeNodeState(e){if(isDown||"mousedown"===e.type){if(!currentState)return void console.error("Current state is "+currentState);clearPath();var t=e.target.getAttribute("x"),o=e.target.getAttribute("y"),a=getTargetNode(t,o);console.log("x:"+t+",y:"+o),console.dir(a),"deleteObject"!==currentState&&"select"!==currentState?(a.state=""+currentState,a.element.className="node "+currentState,loseFocusOnSelected()):"select"!==currentState||selectedNode?selectedNode?(a.element.id="selected",selectedNode.id="",selectedNode=a.element):(a.state=null,a.element.className="node"):(a.element.id="selected",selectedNode=a.element),startExists&&"start"===currentState?(startNode.element.className="node",startNode.state=null,startNode=a):goalExists&&"goal"===currentState&&(goalNode.element.className="node",goalNode.state=null,goalNode=a),startExists||"start"!==currentState?goalExists||"goal"!==currentState||(goalExists=!0,goalNode=a):(startExists=!0,startNode=a),console.log("%c"+("Targeting: ("+t+","+o+") ==> state: "+a.state),"color: orange; font-weight: bold")}}function clearPath(){var e=document.querySelectorAll(".path");e.forEach(function(e){e.classList="node"})}function setStateToSelect(){currentState="select"}function setStateToStart(){currentState="start",clearPath()}function setStateToGoal(){currentState="goal",clearPath()}function setStateToTree(){currentState="tree",clearPath()}function setStateToWall(){currentState="wall",clearPath()}function setStateToWater(){currentState="water",clearPath()}function resetMap(){for(var e=document.querySelector("#map");e.firstChild;)e.removeChild(e.firstChild);gameMap=generateMap(10)}function setStateToDeleteObject(){currentState="deleteObject"}function loseFocusOnSelected(){selectedNode&&(selectedNode.id=""),selectedNode=void 0}function searchForGoal(){console.log(startNode),showPath(breadthFirstSearch(startNode,goalTest,actions,successor))}function showPath(e){e||alert("Your adventurer's path is blocked!"),e.pop();var t=startNode,o=[];e.forEach(function(e){"up"===e?(t=getTargetNode(t.x,t.y+1),o.push(t.element)):"left"===e?(t=getTargetNode(t.x-1,t.y),o.push(t.element)):"right"===e?(t=getTargetNode(t.x+1,t.y),o.push(t.element)):"down"===e&&(t=getTargetNode(t.x,t.y-1),o.push(t.element))}),o.forEach(function(e){e.classList+=" path"})}var gameMap=generateMap(10),currentState=void 0,startExists=!1,startNode=void 0,goalExists=!1,goalNode=void 0,selectedNode=void 0,isDown=!1;$(document).mousedown(function(){isDown=!0}),$(document).mouseup(function(){isDown=!1});var playButton=document.querySelector(".fa-play-circle-o"),stopButton=document.querySelector(".fa-stop-circle-o"),defaultTool=document.querySelector(".fa-mouse-pointer"),startTool=document.querySelector(".start-ui-button"),goalTool=document.querySelector(".goal-ui-button"),treeTool=document.querySelector(".tree-ui-button"),wallTool=document.querySelector(".wall-ui-button"),waterTool=document.querySelector(".water-ui-button"),deleteObjectTool=document.querySelector(".fa-trash"),reset=document.querySelector(".restart-ui-button");playButton.addEventListener("click",searchForGoal),stopButton.addEventListener("click",clearPath),defaultTool.addEventListener("click",setStateToSelect),startTool.addEventListener("click",setStateToStart),goalTool.addEventListener("click",setStateToGoal),treeTool.addEventListener("click",setStateToTree),wallTool.addEventListener("click",setStateToWall),waterTool.addEventListener("click",setStateToWater),reset.addEventListener("click",resetMap),deleteObjectTool.addEventListener("click",setStateToDeleteObject),document.addEventListener("keydown",function(e){13===e.keyCode?(currentState=null,loseFocusOnSelected(),searchForGoal()):8===e.keyCode&&(selectedNode?(selectedNode.state=null,selectedNode.classList="node",loseFocusOnSelected()):currentState="deleteObject",clearPath())});